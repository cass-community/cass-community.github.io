{% comment %}
  Custom sidebar for event pages

  Displays event date, location, and artifacts
{% endcomment %}
<div class="sidebar">

  {% comment %}
    Decompose start and end dates for display purposes
  {% endcomment %}
  {% if page.startdate %}
    {% assign start_y = page.startdate | date: "%Y" %}
    {% assign start_md = page.startdate | date: "%b %d" %}
    {% assign start_m = page.startdate | date: "%b" %}
    {% assign start_d = page.startdate | date: "%d" %}
  {% endif %}
  {% if page.enddate %}
    {% assign end_y = page.enddate | date: "%Y" %}
    {% assign end_md = page.enddate | date: "%b %d" %}
    {% assign end_m = page.enddate | date: "%b" %}
    {% assign end_d = page.enddate | date: "%d" %}
{% endif %}

{% assign event_y = start_y %}
{% if end_y and end_y != start_y %}
  {% assign event_y = event_y | append: "-" | append: end_y %}
{% endif %}

{% assign event_md = start_md %}
{% if end_md and end_m != start_m %}
  {% assign event_md = event_md | append: "-" | append: end_md %}
{% elsif end_md and end_m == start_m %}
  {% unless end_d == start_d %}{% comment %} A corner case {% endcomment %}
    {% assign event_md = event_md | append: "-" | append: end_d %}
  {% endunless %}
{% endif %}

<h3 ><small>{{ event_y }}</small><br>
<span style="line-height: 250%">{{ event_md }}</span><br>
<small>{{ page.time }}</small></h3></h3>

<ul style="list-style: none; padding: 0">
  {% if page.location %}<li>Location: {{ page.location }}</li>{% endif %}
  {% if page.artifacts %}
    {% include emit-artifacts.html artifacts=page.artifacts format="li" %}
  {% endif %}
</ul>

{% comment %}
  Show registration link

  If the link is provided and if the event is upcoming
{% endcomment %}

{% if page.enddate %}
  {% include upcoming-event event=page.enddate %}
{% elsif page.startdate %}
  {% include upcoming-event event=page.startdate %}
{% else %}
  {% assign upcoming = false %}
{% endif %}

{% if upcoming and page.registration-url %}
  <a class="btn btn--inverse btn--large" href="{{ page.registration-url }}">Register for the Event</a>
{% endif %}

{% comment %}
  Including here rather than at the bottom of the main content
{% endcomment %}
{% if page.share %}{% include social-share.html %}{% endif %}

</div>