---
title: WarpX Enables Computational Design of Next-Generation Plasma-Based Accelerators
date: 2025-01-14
teaser: 2025-01-02-warpx-teaser.png
software_mentioned:
  - xSDK
  - libEnsemble
  - MAGMA
  - AMReX
  - Spack
  - E4S
  - HDF5
  - ADIOS
  - PnetCDF
  - ParaView
  - Catalyst
  - Ascent
  - VisIt
  - VTK-m
  - Kokkos
  - Open MPI
  - MPICH

  
excerpt: WarpX is a particle-in-cell (PIC) simulation code that models the motion of charged particles or plasma. WarpX is used to model chains of plasma-based particle accelerators for future high-energy physics colliders – table-top particle accelerators. These table-top accelerators can be used in both scientific and medical applications.
---
## The Science

WarpX is a particle-in-cell (PIC) simulation code that models the motion of charged particles or plasma.  WarpX is used to model chains of plasma-based particle accelerators for future high-energy physics colliders -- table-top particle accelerators.  These table-top accelerators can be used in both scientific and medical applications.  

WarpX was the 2022 winner of the Association for Computer Machinery (ACM) Gordon Bell Award, a prestigious award recognizing outstanding achievement in high performance computing.  ([WarpX Gordon Bell citation](https://www.computer.org/csdl/proceedings-article/sc/2022/544400a025/1I0bSKaoECc)).

## The Enabling Software

WarpX relies on a wide range of scientific software to support its capabilities.  The following highlights the use of CASS member organizations software used by WarpX.  

## Math Libraries

### FASTMath Libraries and xSDK

xSDK, a FASTMath member, is a collection of related, complimentary, and interoperable math libraries.  The FASTMath libraries used by WarpX include libEnsemble (for parameter studies), AMReX (for adaptive mesh refinement capabilities), and MAGMA (GPU-enable BLAS and LAPACK capabilities).  By linking in various math libraries via FASTMath’s xSDK, WarpX can readily incorporate additional math libraries when needed.

{% capture img %}{% include hl-image-path image="2025-01-10-warpx-images/warpx-amrex.png" %}{% endcapture %}
{% include figure class="half" popup=true image_path=img alt="Image showing a laser wakefield acceleration" caption="Impact of AMReX integration with WarpX: Simulation of laser wakefield acceleration performed with WarpX. The laser pulse propagates from left to right in a uniform plasma. A moving window is used, i.e. the simulation box travels at the speed of light to follow the laser pulse. The central slice of plasma electrons is shown as transparent white dots. A cavity free of plasma electrons forms in the laser wake, where an electron bunch (solid white dots) is accelerated. The colormap shows the longitudinal electric field in the wake. The white box in the center shows the mesh-refined area.  Image courtesy of Maxence Thévenet & the WarpX team.  Description from [AMReX image gallery](https://amrex-codes.github.io/amrex/gallery.html)." %}

## Software Ecosystem and Delivery

### Spack and E4S

WarpX has a [Spack Build](https://packages.spack.io/package.html?name=warpx) and is on the [E4S Doc Portal](https://e4s-project.github.io/DocPortal.html).

## Data and Visualization

WarpX has a broad base of users who leverage the many data analysis and visualization tools developed and supported over the decades by the DOE Office of Science ASCR program.  Improvements and development of new data analysis and visualization capabilities as part of the Exascale Computing Project benefited WarpX both generally, e.g., through enhanced GPU capabilities and specifically, e.g., through adding readers to support the various WarpX I/O formats.  These data and visualization software products are in the RAPIDS2 CASS member organization.

### HDF5 and ADIOS

WarpX allows many output file formats, including VTK visualization files and OpenPMD compatible I/O (*open standard for particle-mesh data files*) which is a metadata naming convention.  WarpX specifically requires HDF5 to be linked in when using OpenPMD.  ADIOS specifically added OpenPMD and BP capabilities to support WarpX I/O libraries.  

### Paraview and Catalyst (in situ)

ParaView is a commonly used open source post-processing visualization application. WarpX users can visualize, analyze and explore simulation data via ParaView.  ParaView's GPU capabilities benefit users such as WarpX.  ParaView specifically developed an OpenPMD reader for WarpX. Catalyst, the in situ API, can be integrated into a simulation code to run the visualization and analysis tasks while the simulation is running.

{% capture img %}{% include hl-image-path image="2025-01-10-warpx-images/ez-slice_paraview.png" %}{% endcapture %}
{% include figure popup=true image_path=img alt="Images showing electric and magnetic fields in a WarpX simulation" caption="z-component of the electric field in a WarpX data set using ParaView in client server mode on the OLCF Crusher machine (precursor to Frontier) using 96 nodes and ParaView 5.11.0 deployed with Spack." %}

{% capture img %}{% include hl-image-path image="2025-01-10-warpx-images/bx-slice_paraview.png" %}{% endcapture %}
{% include figure popup=true image_path=img alt="Images showing electric and magnetic fields in a WarpX simulation" caption="x-component of the magnetic field in a WarpX data set using ParaView in client server mode on the OLCF Crusher machine (precursor to Frontier) using 96 nodes and ParaView 5.11.0 deployed with Spack." %}

{% comment %}
<figure>
  <img src="/new/assets/highlights/2025-01-10-warpx-images/ez-slice_paraview.png">
  <img src="/new/assets/highlights/2025-01-10-warpx-images/bx-slice_paraview.png">

    <figcaption>
      z-component of the electric field and x-component of the magnetic field in a WarpX data set using ParaView in client server mode on the OLCF Crusher machine (precursor to Frontier) using 96 nodes and ParaView 5.11.0 deployed with Spack.
    </figcaption>
</figure>
{% endcomment %}

### Ascent

Ascent is a lightweight in situ visualization framework.  WarpX was an early user of the Ascent Replay capability which allows a simulation code to easily and cheaply develop its visualization pipeline on low resolution data before running at high resolution.  

{% capture img %}{% include hl-image-path image="2025-01-10-warpx-images/ascent-warpx.png" %}{% endcapture %}
{% include figure popup=true image_path=img alt="Images showing pulse of electrons in an electric fields in a WarpX simulation" caption="A pulse of electrons (small yellowish blob) moves through the electric field in a laser-accelerated wake field from the WarpX simulation, integrated with Ascent." %}

### VisIt

VisI is another common post hoc visualization tool.  VisIt also developed an OpenPMD reader for WarpX output files, along with GPU capabilities.  In the below image, a WarpX simulation is rendered on the OLCF Crusher machine (a precursor to Frontier).  

{% capture img %}{% include hl-image-path image="2025-01-10-warpx-images/visit-warpx.png" %}{% endcapture %}
{% include figure popup=true image_path=img alt="Image showing electric and magnetic fields in a WarpX simulation" %}

### VTK-m

ParaView, Ascent and VisIt all leverage the VTK-m visualization library to support their GPU capabilities.  

## Programming Models and Runtime Libraries

### Kokkos and MPI

Kokkos is an optional backend for VTK-m for GPU performance and can be leveraged by simulations such as WarpX for efficient visualization tasks on the GPU.  

WarpX allows multiple variants of MPI via Spack build flags. Open MPI and MPICH are part of the S4PST CASS member organization, as is Kokkos.

### Development Tools

The suite of development tools in the STEP CASS member organization are designed to be used by scientific simulation codes for parallel high-performance application debugging and performance profiling.  These tools include Darshan, HPCToolkit, PAPI, TAU and Dyninst.  

### Background material

WarpX Citation: 
> Fedeli L, Huebl A, Boillod-Cerneux F, Clark T, Gott K, Hillairet C, Jaure S, Leblanc A, Lehe R, Myers A, Piechurski C, Sato M, Zaim N, Zhang W, Vay J-L, Vincenti H. Pushing the Frontier in the Design of Laser-Based Electron Accelerators with Groundbreaking Mesh-Refined Particle-In-Cell Simulations on Exascale-Class Supercomputers. SC22: International Conference for High Performance Computing, Networking, Storage and Analysis (SC). ISSN:2167-4337, pp. 25-36, Dallas, TX, US, 2022. DOI:10.1109/SC41404.2022.00008